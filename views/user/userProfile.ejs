<%- include('../partials/header.ejs') %>
    <div class="userProfile">

        <!-- model for comment -->
        <div class="profileModal mx-auto" id="profileModal">
        
        </div>


        <nav class="navbar profileNav navbar-light bg-light">
            <a class="navbar-brand" href="/user/home">Blogger</a>
            <a href="/user/logout" data-bs-toggle="tooltip" title="Logout"> 
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"/>
                    <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"/>
                </svg>
            </a>
        </nav>
        <section>
            <div class="user-profile-section1 container-fluid d-flex">

                <div class="userData">
                    <span class="w-75 d-flex">
                        <h4 class="p-4 pt-5"><%=user.username%> <span style="font-size: medium;">(<%=user.email%>)</span></h4>
                        <%if(String(user._id) == String(curUser)){%>
                            <%if(!user.following.includes(curUser)){%>
                                <a class="userEditBtn" href="/user/editProfile">
                                    Edit
                                    <svg viewBox="0 0 512 512" class="svg">
                                        <path
                                        d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"
                                        ></path>
                                    </svg>
                                </a>
                            <%}else{%>
                                <a class="userEditBtn" href="/user/editProfile">
                                    Edit
                                    <svg viewBox="0 0 512 512" class="svg">
                                        <path
                                        d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"
                                        ></path>
                                    </svg>
                                </a>
                            <%}%>
                        <%}%>
                        <input type="hidden" id="userIdHidden" value="<%=user._id%>">
                        <%if(String(user._id) != String(curUser)){%>
                            <%if(!user.following.includes(curUser)){%>
                                <a class="follow-link" id="follow-link">➕ Follow</a>
                            <%}else{%>
                                <a class="follow-link" id="following-link">✔️ Following</a>
                            <%}%>
                        <%}%>
                    </span>

                    <ul>
                        <li>
                            <h1><%=blogs.length%></h1>
                            <span>POST</span>
                        </li>
                        <li>
                            <h1><%=user.follows.length%></h1>
                            <span>FOLLOWS</span>
                        </li>
                        <li>
                            <h1><%=user.following.length%></h1>
                            <span>FOLLOWING</span>
                        </li>
                    </ul>
                </div>
                <div class="profieImgDiv position-relative">
                    
                    <div id="profileImage" class="profileImage" style="background-image: url(/public/uploads/<%=user.image%>);"></div>
                </div>
            </div>
        </section>
        <section>
            <div class="post-list pb-5">
                <section class="d-flex flex-column bannerDiv position-relative">

                    <div class="title position-absolute top-0">
                        <%if(String(user._id) == String(curUser)){%>
                            <h5>Your Blogs</h5> 
                        <%}%>
                    </div>
                    <%if(blogs.length > 0){%>
                    <% blogs.forEach( blog => { %>
                        <section class="d-flex profile-user-blogs">
                            <div class="bannerSubDiv1">
                                <article>
                                    <p class="date"><%=blog.createdAt.toLocaleDateString('en-GB',{
                                        day: 'numeric', 
                                        month: 'long', 
                                        year: 'numeric' 
                                    });%></p>
                                    <h3 style="font-weight: bold;" class="pb-3"><%=blog.title%></h3>
                                    <p class="p-0 m-0 px-2">
                                        <%=blog.description%>
                                    </p>
                                    
                                    <%if(String(user._id) == String(curUser)){%>
                                        <div class="d-flex align-item-center">
                                            <button class="blogEditBtn" id="blogEditBtn" data-edit-blog-id="<%=blog.id%>">
                                                <svg height="1em" viewBox="0 0 512 512">
                                                <path
                                                    d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"
                                                ></path>
                                                </svg>
                                            </button>

                                            <button class="button deleteBlogBtn" id="deleteBlogBtn" data-blog-id="<%=blog._id%>">
                                                <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                fill="none"
                                                viewBox="0 0 69 14"
                                                class="svgIcon bin-top"
                                                >
                                                <g clip-path="url(#clip0_35_24)">
                                                    <path
                                                    fill="black"
                                                    d="M20.8232 2.62734L19.9948 4.21304C19.8224 4.54309 19.4808 4.75 19.1085 4.75H4.92857C2.20246 4.75 0 6.87266 0 9.5C0 12.1273 2.20246 14.25 4.92857 14.25H64.0714C66.7975 14.25 69 12.1273 69 9.5C69 6.87266 66.7975 4.75 64.0714 4.75H49.8915C49.5192 4.75 49.1776 4.54309 49.0052 4.21305L48.1768 2.62734C47.3451 1.00938 45.6355 0 43.7719 0H25.2281C23.3645 0 21.6549 1.00938 20.8232 2.62734ZM64.0023 20.0648C64.0397 19.4882 63.5822 19 63.0044 19H5.99556C5.4178 19 4.96025 19.4882 4.99766 20.0648L8.19375 69.3203C8.44018 73.0758 11.6746 76 15.5712 76H53.4288C57.3254 76 60.5598 73.0758 60.8062 69.3203L64.0023 20.0648Z"
                                                    ></path>
                                                </g>
                                                <defs>
                                                    <clipPath id="clip0_35_24">
                                                    <rect fill="white" height="14" width="69"></rect>
                                                    </clipPath>
                                                </defs>
                                                </svg>
                                            
                                                <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                fill="none"
                                                viewBox="0 0 69 57"
                                                class="svgIcon bin-bottom"
                                                >
                                                <g clip-path="url(#clip0_35_22)">
                                                    <path
                                                    fill="black"
                                                    d="M20.8232 -16.3727L19.9948 -14.787C19.8224 -14.4569 19.4808 -14.25 19.1085 -14.25H4.92857C2.20246 -14.25 0 -12.1273 0 -9.5C0 -6.8727 2.20246 -4.75 4.92857 -4.75H64.0714C66.7975 -4.75 69 -6.8727 69 -9.5C69 -12.1273 66.7975 -14.25 64.0714 -14.25H49.8915C49.5192 -14.25 49.1776 -14.4569 49.0052 -14.787L48.1768 -16.3727C47.3451 -17.9906 45.6355 -19 43.7719 -19H25.2281C23.3645 -19 21.6549 -17.9906 20.8232 -16.3727ZM64.0023 1.0648C64.0397 0.4882 63.5822 0 63.0044 0H5.99556C5.4178 0 4.96025 0.4882 4.99766 1.0648L8.19375 50.3203C8.44018 54.0758 11.6746 57 15.5712 57H53.4288C57.3254 57 60.5598 54.0758 60.8062 50.3203L64.0023 1.0648Z"
                                                    ></path>
                                                </g>
                                                <defs>
                                                    <clipPath id="clip0_35_22">
                                                    <rect fill="white" height="57" width="69"></rect>
                                                    </clipPath>
                                                </defs>
                                                </svg>
                                            </button>
                                            

                                        </div>
                                        <!-- denoting number of likes and comments -->
                                        <% if (blog.likes.length > 0) { %>
                                            <i>
                                                <span style="font-size: smaller; color: rgba(0, 0, 0, 0.591);"><%=blog.likes.length %> users liked the blog</span>
                                            </i>
                                        <%}%>
                                        <% if (blog.comments.length > 0) { %>
                                            <i>
                                                <span style="font-size: smaller; color: rgba(0, 0, 0, 0.591);"><%=blog.comments.length %> users commented on the blog</span>
                                            </i>
                                        <%}%>

                                    <%}else{%>
                                        <div class="likeAndComments">
                                            <% if (blog.likes.includes(curUser)) { %>
                                                <div class="large-font text-center">
                                                    <svg class="svg-heart" data-like-blog-id="<%= blog._id %>" data-isliked="true"  data-like-user-id="<%= curUser %>" xmlns="http://www.w3.org/2000/svg"  width="30" height="30" viewBox="0 0 512 512" fill="red">
                                                        <path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/>
                                                    </svg>
                                                </div>
                                            <% } else { %>
                                                <div class="large-font text-center">
                                                    <svg class="svg-heart" data-like-blog-id="<%= blog._id %>" data-isliked="false"  data-like-user-id="<%= curUser %>" xmlns="http://www.w3.org/2000/svg"  width="30" height="30" viewBox="0 0 512 512" fill="grey">
                                                        <path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/>
                                                    </svg>
                                                </div>
                                            <% } %>
                                            
                                            
                                            <div class="commentDiv">
                                                <i class="fa-solid profile-fa-comment-dots fa-comment-dots  fa-2xl ml-2" style="color: grey;" data-blog-id="<%=blog._id%>"></i>
                                            </div>
                
                
                                            <div class="profileShareButton" id="profileShareButton" >
                                                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" id="share" class="pt-1">
                                                    <path d="m23.665 8.253-9-8A.998.998 0 0 0 13 1v3.207C9.996 5.013 0 8.765 0 23a1 1 0 0 0 1.928.371c2.965-7.413 8.745-8.96 11.071-9.283V17a1 1 0 0 0 1.666.747l9-8a1 1 0 0 0 0-1.494z"></path>
                                                </svg>
                                            </div>
                                        </div>
                                    <%}%>
                                </article>
                            </div>
                            <div class="bannerSubDiv2" style="background-image: url(../../public/uploads/<%=blog.postImg%>);"></div>
                        </section>
                    <%})} else {%>
                        <section class="d-flex">
                            <img src="../../public/images/3973481.jpg" height="50%" width="80%">
                        </section>
                    <%}%>
                    
                </section>
            </div>
        </section>
        
        
    </div>
    

<%- include('../partials/footer.ejs') %>
